\newcommand{\isSt}{\mathsf{isStone}}


\begin{definition}
  A countably presented Boolean algebra $B$ is a Boolean algebra such that there merely are 
  %decidable 
  countable sets $I,J$, 
  a set of generators $g_i,~{i\in I}$ and a set $f_j,~{j\in J}$ of Boolean expressions over these generators 
  such that $B$ is equivalent to the quotient of the free Boolean algebra over the generators by the relations
  $f_j=0$. 
\end{definition} 
If $I,J$ are finite, we call $B$ a finitely presented Boolean algebra. 

\begin{remark}
  As Boolean algebras are rings, any relation of the form $f=g$ with both $f,g$ Boolean expressions 
  can be written as $h=0$ with $h=f-g$ a Boolean expression. 
\end{remark} 
We can express a countably presented Boolean algebra as the colimit of a finitely presented Boolean algebra. 
This is the formulation closer to \cite{Scholze}.

\input{Profinite}

\medskip

In SAG, we deal with a fixed commutative ring $R$. For this project, the role of $R$ is taken over by 
the Boolean algebra $2 = 1+1$. Note that we don't need to postulate an alternative for the \textbf{Loc} axiom. 
We write $\Boole$ the type of countably presented Boolean algebras.
Note that as each Boolean algebra is a Set, we $\Boole$ is a subtype of $hSet$.
Also, as being countable is a notion independent of universes, $\Boole$ is independent of universes.

\medskip

\begin{definition}
  For $B$ a countably presented Boolean algebra, we define $Sp(B)$ as the set of Boolean morphisms from $B$ to $2$. 
\end{definition}

\medskip

An example of element of $\Boole$ is the free algebra $C$ on countably many generators. The corresponding set $Sp(C)$
is then Cantor space $2^{\N}$.

Another example is the algebra $B_{\infty}$ generated by $p_n$ with relations $p_np_m = 0$ for $n\neq m$. The corresponding
set $Sp(B_{\infty})$ is the set $\Noo$ of binary sequences with at most one element $\neq 0$.

\begin{axiom}[Stone duality]
  For any countably presented Boolean algebra $B$, the evaluation map   $B\rightarrow  2^{Sp(B)}$ is an isomorphism.
  %% \begin{equation}
  %%   \prod_{B : \Boole} B \simeq 2^{Sp(B)}
  %% \end{equation} 
\end{axiom} 

\begin{definition}
  We define the predicate on types $\isSt$ by 
  \begin{equation}
    \isSt(X) = \sum\limits_{B : Boole} X = Sp(B)
  \end{equation} 
  A type $X$ is called \textit{Stone} if $\isSt(X)$ is inhabited.
\end{definition}

\begin{lemma}
  $\isSt(X)$ is a proposition for every $X$. 
\end{lemma} 


%% THE PROOF NEEDS TO BE REWRITTEN

%% \begin{proof}
%% %  We'll show that $is-Stone$ is contractible as soon as it is inhabited. 
%%   Let $(B,p), (B',p'): \isSt(X)$. 
  
%% %  As $Sp(B) = X = Sp(B')$, by Stone duality we have $$B \simeq 2^{Sp(B)} \simeq 2^{Sp(B')} \simeq B'.$$
%%   Furthermore, 
%%   for $SD: 2^{Sp(B')} = 2^{Sp(B)} \to B' = B$ conjugation by Stone duality, the map 
%%   $$SD \circ tr_{2^-} : Sp(B') = Sp(B) \to B' = B$$
%%   has inverse $tr_{Sp}$ by a path induction argument. 
%%   Therefore 
%%   $$
%%     \sum\limits_{B' : BA} Sp(B') = Sp(B)  
%%     \simeq 
%%     \sum\limits_{B' : BA} B' = B  
%%     $$
%%     as the latter is contractible, so is the former. 
%%     Hence $(B,refl) = (B', p' \cdot p ^{-1})$ and $(B,p) = (B',p')$. 
%%     Thus $\isSt(X)$ is contractible for any $X$. 
%% \end{proof} 

%\begin{remark}
%  By Stone duality, if $Sp(B) \simeq  Sp(B')$, then 
%  Furthermore, for any Boolean algebra $B$, we have that the composite
%
%  \begin{equation} \begin{tikzcd}
%    \sum\limits_{B' : BA} Sp(B') = Sp(B) \arrow[r, "tr_{2^\_}"] & 
%    \sum\limits_{B' : BA} 2^{Sp(B')} = 2^{Sp(B)} \arrow[r , "SD(B')^{-1} \cdot \_ \cdot SD(B)"]&
%    \sum\limits_{B' : BA} B' = B  
%   % \arrow[r, "tr_{Sp}"] & 
%   % \sum\limits_{B' : BA} Sp(B') = Sp(B) 
%  \end{tikzcd}   \end{equation} 
%  is an equivalence. As the latter type is contractible, being Stone is a proposition. 
%\end{remark} 

It thus follows from the first axiom that $Sp$ is an embedding from $\Boole$ to any universe of types. We call
$\Stone$ its image. Both groupoids $\Boole$ and $\Stone$ have a natural category structure.
The map $Sp$ defines then an anti-equivalence of categories between these two categories.

Any Stone set has a natural topology, where basic open are decidable subsets.

\medskip

\begin{proposition}
Any map $f: Sp(B)\rightarrow\N$ is uniformely continuous.
\end{proposition}  

\begin{proof}
  For each natural number $n$, the fiber $f^{-1}(n)$ is a decidable
  subset of $Sp(B)$. Via the isomorphism $B\rightarrow 2^{Sp(B)}$, this corresponds to an element $e_n$ of $B$. We have
  $e_ne_m = 0$. Furthermore the quotient $B'$ of $B$ by the relations $e_n = 0$ is such that $Sp(B') = 0$ and hence
  $1 = 0$ in $B'$, so we have $N$ such that $1 = \vee_{i<N}e_i$.
\end{proof}

\medskip

In formal/point-free topology, we consider that a Boolean algebra $B$ represents a Stone space $Sp(B)$ and a map
$Sp(B') \to Sp(B)$ is represented by a map $B\rightarrow B'$; the map $Sp(B')\to Sp(B)$ is then said to be
{\em formally surjective} if the corresponding map $B\to B'$ is injective. In the topos of light condensed sets,
this becomes a true duality.

\begin{proposition}
Markov's Principle holds, if we have $\neg \forall_n\alpha(n) = 0$ then we have $\exists_n \alpha(n) = 1$.
\end{proposition}

\begin{proof}
  Let $B$ be the Boolean algebra presented by $\alpha(n)$. We have $Sp(B) = \emptyset$ and hence by duality
  $B$ is trivial, which means that we have $n$ such that $\alpha(n) = 1$.
\end{proof}






\begin{axiom}[Surjections are Formal Surjections]
  A map $f:Sp(B')\to Sp(B)$ is surjective iff the corresponding map $B \to B'$ is injective.
\end{axiom} 

Another way to state this axiom is that epimorphisms in the category $\Stone$ are exactly the surjective maps.

Yet another formulation is $(\neg \neg X)\rightarrow \propTrunc{X}$ for $X$ Stone space.

\medskip

An example of a surjective map (since it is an epimorphism, since it corresponds to a monomorphism via the anti-equivalence
between $\Stone$ and $\Boole$) is the map sum of the maps $\Noo\rightarrow \Noo$ sending $n$ to $2n$ (resp. $n$ to $2n+1$).
This map has no section. This shows that $\Noo$ is not projective.

Here is another way to formulate this result.

\begin{proposition}
  LLPO is a consequence of Axioms $1$ and $2$.
\end{proposition}

A consequence of this characterisation of surjective maps is the following.

\begin{proposition}
  The image of any map between two Stone types is Stone.
\end{proposition}

Here is an example showing how to use this axiom. A closed subset of a Stone set is given by a countable
intersection of decidable subset.

\begin{proposition}
  Let $f:X'\rightarrow X$ a surjective map and $F_n$ a decreasing sequence of closed subsets of $X'$ such that
  each restriction $f_{|F_n}$ is surjective. Then if $F = \cap_n F_n$ the restriction $f_{|F}$ is still surjective.
\end{proposition}

\begin{proof}
  Dually, we have an injective map $i:B\rightarrow B'$ with an increasing sequence $I_n$ of ideals of $B'$ such that
  $b = 0$ if $i(b) = 0$ mod. $I_n$. The subset $F$ corresponds to the ideal $I = \cup_n I_n$. If $i(b) = 0$ mod. $I$
  then we have $i(b) = 0$ mod. $I_n$ for some $n$ and $b = 0$. 
\end{proof}





\begin{axiom}[Local choice]
  Whenever $X$ Stone and $E\twoheadrightarrow X$ surjective, then there is some $Y$ Stone,
    a surjection $Y \twoheadrightarrow X$ and a map $Y\to E$ such that the following diagram commutes:
    \begin{equation}\begin{tikzcd}
      E \arrow[d,""',two heads]\\
      X & \arrow[l, "", two heads] Y\arrow[lu, ""']
    \end{tikzcd}\end{equation}  
\end{axiom} 




The last axiom is Dependent Choice.

\begin{axiom}[Dependent Choice]
  Given a family of types $E_n$ and $R_n:E_n\rightarrow E_{n+1}\rightarrow {\mathcal U}$ such that
  for all $n$ and $x:E_n$ there exists $y:E_n$ with $p:R~x~y$ then given $x_0:E_0$ there exists
  $u:\Pi_{n:\N}E_n$ and $v:\Pi_{n:\N}R~(u~n)~(u~(n+1))$ and $u~0 = x_0$.
\end{axiom}

\medskip

One basic result about the category $\Boole$, the existence of retraction for non empty closed subset inclusion
holds only {\em non} constructively and in our setting we can prove the following.


\begin{proposition}
 It is not the case that for all closed proposition $p$ the inclusion $1+p\rightarrow 1+1$ has a retraction.
\end{proposition}

\begin{proof}
  This implies that all closed propositions are decidable and the proposition $x=\infty$ for $x$ in $\Noo$ is a
  closed proposition which is not decidable.
\end{proof}

\medskip

We can define the set $\Closed$ of closed propositions, where a proposition is closed iff it is equivalent to
the proposition $\forall_n \alpha(n) = 0$ for some $\alpha$ in $2^{\N}$.

\begin{theorem}
  Monomorphisms in $\Stone$ are classified by $\Closed$.
\end{theorem}

\medskip

We have seen that $\Noo$ is not projective. Using Local and Dependent Choice, David noticed that Scholze's argument
about $\ints[\Noo]$ cannot be made internal.

\begin{theorem}
   $\ints[\Noo]$ is {\em not} projective in the category of Abelian Groups.
\end{theorem}

