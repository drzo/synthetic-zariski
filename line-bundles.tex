\subsection{Line bundles on $\A^1$}

\begin{definition}%
  Let $X$ be a type.
  A \notion{line bundle} is a map $\mathcal L : X\to \Mod{R}$,
  such that
  \[ \prod_{x:X} \propTrunc{\mathcal L_x=_{\Mod{R}}R} \rlap{.}\]
  The \notion{trivial line bundle} on $X$ is the line bundle
  $X \to \Mod{R}, x \mapsto R$,
  and when we say that a line bundle $\mathcal{L}$ is trivial
  we mean that $\mathcal{L}$ is equal to the trivial line bundle,
  or equivalently $\propTrunc{\prod_{x:X} \mathcal L_x=_{\Mod{R}}R}$.
\end{definition}

\begin{lemma}[using \axiomref{loc}, \axiomref{sqc}]%
  \label{polynomials-notnot-decompose}
  Let $f : R[X]$ be a polynomial.
  Then it is not not the case that:
  either $f = 0$ or
  $f = \alpha \cdot {(X - a_1)}^{e_1} \dots {(X - a_n)}^{e_n}$
  for some $\alpha : R^\times$,
  $e_i \geq 1$ and pairwise distinct $a_i : R$.
\end{lemma}

\begin{proof}
  Let $f : R[X]$ be given.
  Since our goal is a proposition,
  we can assume we have a bound $n$ on the degree of $f$,
  so
  \[ f = \sum_{i = 0}^n c_i X^i \rlap{.} \]
  Since our goal is even double-negation stable,
  we can assume $c_n = 0 \lor c_n \neq 0$
  and by induction $f = 0$ (in which case we are done)
  or $c_n \neq 0$.
  If $n = 0$ we are done,
  setting $\alpha \colonequiv c_0$.
  Otherwise,
  $f$ is not invertible (using $0 \neq 1$ by (\axiomref{loc})),
  so $R[X]/(f) \neq 0$,
  which by (\axiomref{sqc}) means that
  $\Spec(R[X]/(f)) = \{ x : R \mid f(x) = 0 \}$
  is not empty.
  Using the double-negation stability of our goal again,
  we can assume $f(a) = 0$ for some $a : R$
  and factor $f = (X - a_1) f_{n - 1}$.
  By induction, we get $f = \alpha \cdot (X - a_1) \dots (X - a_n)$.
  Finally, we decide each of the finitely many propositions $a_i = a_j$,
  which we can assume is possible
  because our goal is still double-negation stable,
  to get the desired form
  $f = \alpha \cdot {(X - \widetilde{a}_1)}^{e_1} \dots {(X - \widetilde{a}_n)}^{e_n}$
  with distinct $\widetilde{a}_i$.
\end{proof}

\begin{lemma}[using \axiomref{loc}, \axiomref{sqc}, \axiomref{Z-choice}]
  For every open subset $U : \A^1 \to \Prop$ of $\A^1$
  we have not not:
  either $U = \emptyset$
  or $U = D((X - a_1)\dots(X - a_n)) = \A^1 \setminus \{ a_1, \dots, a_n \}$
  for pairwise distinct numbers $a_1, \dots, a_n : R$.
\end{lemma}

\begin{proof}
  For $U = D(f)$,
  this follows from \cref{polynomials-notnot-decompose}
  because $D(\alpha \cdot {(X - a_1)}^{e_1} \dots {(X - a_n)}^{e_n})
  = D((X - a_1) \dots (X - a_n))$.
  In general,
  we have $U = D(f_1) \cup \dots \cup D(f_n)$
  by \cref{qc-open-affine-open},
  so we do not not get
  (that $U = \emptyset$ or)
  a list of elements $a_1, \dots, a_n : R$
  such that $U = \A^1 \setminus \{ a_1, \dots, a_n \}$.
  Then we can not not get rid of any duplicates in the list.
\end{proof}

\begin{lemma}[using \axiomref{loc}, \axiomref{sqc}, \axiomref{Z-choice}]%
  \label{decompose-invertible-function-on-intersection-in-A1}
  Let $U, V : \A^1 \to \Prop$ be two open subsets
  and let $f : U \cap V \to R^\times$ be a function.
  Then there do not not exist functions
  $g : U \to R^\times$ and
  $h : V \to R^\times$
  such that $f(x) = g(x)h(x)$ for all $x : U \cap V$.
\end{lemma}

\begin{proof}
  By \cref{polynomials-notnot-decompose},
  we can assume
  \begin{align*}
    U \cup V &= D((X - a_1) \dots (X - a_k)) \rlap{,}\\
    U &= D((X - a_1) \dots (X - a_k) (X - b_1) \dots (X - b_l)) \rlap{,}\\
    V &= D((X - a_1) \dots (X - a_k) (X - c_1) \dots (X - c_m)) \rlap{,}\\
    U \cap V &= D((X - a_1) \dots (X - a_k) (X - b_1) \dots (X - b_l) (X - c_1) \dots (X - c_m))
    \rlap{,}
  \end{align*}
  where all linear factors are distinct.
  Then every function $f : U \cap V \to R^\times$ can
  by (\axiomref{sqc}), \cref{polynomials-notnot-decompose}
  and comparing linear factors
  not not be written in the form
  \[ f = \alpha \cdot
     {(X - a_1)}^{e_1} \dots {(X - a_k)}^{e_k}
     {(X - b_1)}^{e'_1} \dots {(X - b_l)}^{e'_l}
     {(X - c_1)}^{e''_1} \dots {(X - c_m)}^{e''_m}
  \]
  with $\alpha : R^\times$, $e_i, e'_i, e''_i : \Z$.
  Other linear factors can not appear,
  since they do not represent invertible functions on $U \cap V$.
  Now we can write $f = gh$ as desired,
  for example with
  \begin{align*}
    g &= \alpha \cdot
    {(X - a_1)}^{e_1} \dots {(X - a_k)}^{e_k}
    {(X - b_1)}^{e'_1} \dots {(X - b_l)}^{e'_l} \rlap{,}\\
    h &=
    {(X - c_1)}^{e''_1} \dots {(X - c_m)}^{e''_m} \rlap{.}
  \end{align*}
\end{proof}

\begin{theorem}
  Every $R^\times$-torsor on $\A^1$ (\cref{torsor})
  does not not have a global section.
\end{theorem}

\begin{proof}
  Let $T$ be an $R^\times$-torsor on $\A^1$,
  that is,
  for every $x : \A^1$,
  $T_x$ is a set with a free and transitive $R^\times$ action
  and $\propTrunc{T_x}$.
  By (\axiomref{Z-choice}),
  we get a cover of $\A^1$ by open subsets $\A^1 = \bigcup_{i = 1}^n U_i$
  and local sections $s_i : (x : U_i) \to T_x$ of the bundle $T$.
  From this we can not not construct a global section by induction on $n$:
  Given any two local sections $s_i, s_j$ defined on $U_i, U_j$,
  let $f : U_i \cap U_j \to R^\times$ be the unique function with
  $f(x)s_i(x) = s_j(x)$ for all $x : U_i \cap U_j$.
  Then by \cref{decompose-invertible-function-on-intersection-in-A1},
  we not not find $g : U_i \to R^\times$, $h : U_j \to R^\times$
  such that the sections
  $x \mapsto g(x)s_i(x)$ and $x \mapsto {h(x)}^{-1}s_j(x)$,
  defined on $U_i$ respectively $U_j$,
  agree on $U_i \cap U_j$.
  This yields a section $\widetilde{s} : (x : U_i \cup U_j) \to T_x$
  by \cref{kraus-glueing}
  and we can replace $U$ and $V$ by $U \cup V$ in the cover.
  Finally, when we get to $n = 1$,
  we have $U_1 = \A^1$
  and the global section $s_1 : (x : X) \to T_x$.
\end{proof}

\begin{corollary}[using \axiomref{loc}, \axiomref{sqc}, \axiomref{Z-choice}]
  Every line bundle on $\A^1$ is not not trivial.
\end{corollary}

\begin{proof}
  TODO
\end{proof}

\subsection{Regular sections and regular closed subschemes}

In classical algebraic geometry,
there is the concept of a \notion{generic section} of a line bundle.
Informally, the generic sections have the smallest possible vanishing set.
The following definition corresponds to this notion:

\begin{definition}%
  \label{regular-section}
  Let $X$ be a type and $\mathcal L:X\to \Mod{R}$ a line bundle.
  A section
  \[ s:\prod_{x:X}\mathcal L_x \]
  is \notion{regular}, there merely is a trivializing affine cover $U_1=\Spec A_1,\dots,U_n=\Spec A_n$
  of $\mathcal L$, such that each trivialized restriction
  \[ s_i:\Spec A_i\to R \]
  is a regular element (\cref{regular-element}) of $(\Spec A_i\to R) = A_i$.
\end{definition}

\begin{lemma}%
  \label{regular-zariski-local}
  Let $s:\Spec A\to R$.
  $s$ being regular is Zariski-local, i.e.
  for all Zariski-covers $U_1,\dots,U_n$ of $\Spec A$,
  $s$ is regular, if and only if it is regular on all $U_i$.
\end{lemma}

\begin{proof}
  It is enough to check this for a localization at $f:A$.
  Let
  \[ \frac{s}{1}\cdot\frac{g}{f^k}=0\rlap{.} \]
  then $f^lsg=0$, which implies $f^lg=0$ by regularity of $s$ and therefore $\frac{g}{f^l}=0$.
\end{proof}

\begin{proposition}%
  The choice of trivializing cover in \cref{regular-section}
  is irrelevant.
\end{proposition}

\begin{proof}
  By \cref{regular-zariski-local}.
\end{proof}

From a line bundle together with a regular section,
we can produce a closed subtype of a special kind:

\begin{definition}%
  Let $X$ be a scheme.
  A \notion{regular closed subtype} of $X$ is a closed subtype
  $C:X\to \Prop$, such that there merely is an affine open cover $U_1=\Spec A_1,\dots,U_n=\Spec A_n$,
  and $C\cap U_i$ is $V(f_i)$ for a regular $f_i:A_i$.
\end{definition}

\begin{lemma}%
  Let $f,g:A$, $f$ be regular and $V(f)=V(g)$,
  then $g$ is regular and there is a unique unit $\alpha:A^\times$, such that $\alpha f=g$.
\end{lemma}

\begin{proof}
  $V(f)=V(g)$ implies there are $\alpha,\beta:A$ such that
  $\alpha f = g$ and $\beta g = f$.
  But then: $f=\beta g=\beta\alpha f$.
  So by regularity of $f$, $\beta\alpha=1$.
  By \cref{units-products-regular}, units are regular and products of regular elements are regular,
  so $g$ is regular.
  Uniqueness of $\alpha$ follows from regularity.
\end{proof}

\begin{theorem}[using \axiomref{Z-choice}]%
  Let $X$ be a scheme.
  For any regular closed subscheme $C$,
  there is a line bundle with regular section $(\mathcal L,s)$ on $X$,
  such that $C=V(s)$.
\end{theorem}

\begin{proof}
  Let $U_1=\Spec A_1,\dots,U_n=\Spec A_n$ be a cover by standard  affine opens such that we have
  regular $f_i$ with $C\cap U_i=V(f_i)$. 
  We define $\mathcal L$ to be the trivial line bundle $\_\mapsto R$ on each $U_i$
  and by giving automorphisms on the intersections $U_i\cap U_j\colonequiv U_{ij}=\Spec A_{ij}$.
  On $U_{ij}$, $C$ is given by $V(\frac{f_i}{1})$ and $V(\frac{f_j}{1})$ which are both regular.
  Therefore, there is a unit $\alpha:A_{ij}^\times$ such that $\alpha\frac{f_i}{1}=\frac{f_j}{1}$,
  which we can also view as a map $U_{ij}\to R^\times$ and since $R^\times$
  is equivalent to the automorphism group of $R$ as an $R$-module,
  this provides the identetification we need to construct $\mathcal L$.
  Under the identification, the local regular sections are identified, so we get a global section $s$ of $\mathcal L$,
  which is locally regular.
\end{proof}

\subsection{Line Bundles on $\bP^n$}

We will construct Serre's twisting sheaves in this section,
starting with the ``minus first''.
The following works because of \cref{lines-are-one-dimensional}.

\begin{definition}
  The \notion{tautological bundle} is the line bundle $\mathcal O_{\bP^n}(-1):\bP^n\to \Mod{R}$,
  given by
  \[ (L:\bP^n)\mapsto L\rlap{.}\]
\end{definition}

\begin{definition}
  The \notion{dual}\index{$\mathcal L^\vee$} $\mathcal L^\vee$ of a line bundle $\mathcal L:\bP^n\to \Mod{R}$,
  is the line bundle given by
  \[ (x:\bP^n)\mapsto \Hom_{\Mod{R}}(\mathcal L_x,R)\rlap{.}\]
\end{definition}
