We will need the following special case of Horrocks Theorem, for a commutative ring $A$.

\begin{lemma}\label{Horrocks}
  If an ideal of $A[X]$ divides a principal ideal $(f)$ with $f$ monic then it is itself a principal ideal.
\end{lemma}

Let $I$ and $J$ be such that $I\cdot J = (f)$. We can then write $f = \Sigma u_iv_i$ with $u_i$ in $I$ and
$v_i$ in $J$. We then have $I = (u_1,\dots,u_n)$ and $J=(v_1,\dots,v_n)$.
The strategy of the proof is to build comaximal monoids $S_1,\dots,S_l$ in $A$ \cite{LQ} such
that $I$ is generated by a monic polynomial in each $A_{S_j}[X]$.

\subsection{Formal computation of gcd}

 We start by describing a general technique introduced in \cite{LQ}.

If we have a list $u_1,\dots,u_n$ of polynomials over a field we can compute the gcd
so that $(g) = (u_1,\dots,u_n)$ and $g$ is $0$ or a monic polynomial.

In general if we are now over a ring $R$, we can interpret this computation formally as
follows. We build a binary tree of root $R$. At each node of the tree we have a f.p. extension $A$
of $R$. If we want to decide whether an element $a$ in $R$ is invertible or $0$
\footnote{A priori it is an element
of $A$, but we can always assume that this element comes from an element of $R$.}
we open two branches: one with $A\rightarrow A/(a)$ (intuitively we force $a$ to be $0$)
and the other with $A\rightarrow A_a = A[1/a]$ (intuitively we force $a$ to be invertible).

In this way we have at each leaf a f.p. extension $R\rightarrow A$ and in $A$ we have
$g$, a monic polynomial in $A[X]$ or $0$, such that $(g) = (u_1,\dots,u_n)$ in $A[X]$.
Over each branch we have a list of elements $a_1,\dots,a_n$ of $R$ that we force to be
invertible, and a list of elements $b_1,\dots,b_m$ of $R$ that we force to be $0$.
We associate to this branch the multiplicative monoid generated by $a_1\dots a_n$
and $1 + (b_1,\dots,b_m)$. In this way, we build a list of monoids $S_1,\dots,S_l$
that are {\em comaximal} \cite{LQ}: if $s_i$ in $S_i$ then $1 = (s_1,\dots,s_l)$.

\subsection{Application to Horrocks' Theorem}

We assume $f = \Sigma u_iv_i$ and $fp_{ij} = u_iv_j$ with $\Sigma p_{ii} = 1$
in $A[X]$. The goal is to build comaximal monoids $S_1,\dots,S_l$ with $I$ generated by
a monic polynomial in $A_{S_j}[X]$.

We first build a binary tree which corresponds to the formal computation of the gcd of
$u_1,\dots,u_n$ as described above. To each branch we associate an element that
we force to be invertible and a list of elements $b_1,\dots,b_m$ that we force to be $0$.
We write $S$ the multiplicative monoid generated by $a$ and $1 + (b_1,\dots,b_m)$.
We also have a monic polynomial $\gamma$ in $A_S[X]$ 
such that $I = (\gamma)$ in $A_S[X]/(b_1,\dots,b_m)$.

 Note that $I = (u_1,\dots,u_n)$ contains $f$.

\begin{lemma}
  If $p$ is a polynomial in $I$ which is monic in $A_S[X]/(b_1,\dots,b_m)$ of degree $<deg(f)$
  then there exists $h$ monic in
  $A_S[X]$ and in $(u_1,\dots,u_n)$ and such that $p=h$ mod. $(b_1,\dots,b_m)$.
\end{lemma}

\begin{proof}
  (Same proof as in Lam \cite{Lam}.) Let $N$ be the degree of $f$.
  If $I$ also contains a polynomial $q$ which is monic
  mod. $L$ of degree $N-1$, we can kill all coefficients (in $L$) of degree $\geqslant N$
  using $f$, and we get that $I$ also contains a monic polynomial of degree $N-1$
  and equal to $q$ mod. $L$.
  Similarly $I$ will also contains a monic polynomial of degree $N-2$, and so on, until
  we get $h$ monic in $(u_1,\dots,u_n)$ and equal to $p$ mod. $L$.
\end{proof}

By this Lemma, we get a monic polynomial $h$ in $(u_1,\dots,u_n)$ in $A_S[X]$
and such that $I=(h)$ in $A_S[X]/(b_1,\dots,b_m)$.

\begin{lemma}
 $I = (h)$ in $A_{S}[X]$.
\end{lemma}

\begin{proof}
  Let $L$ be $(b_1,\dots,b_m)$ in $A_S[X]$.
  Since $I$ contains $I\cap L$ and $I\cdot J = (f)$ with $f$ regular, we can find $K$
  such that $I\cdot K = I\cap L$.
  We then have $I\cdot K = 0$ mod. $L$ and hence $K = 0$ mod. $L$ since $I$ contains $f$
  which is monic.
  This means $I\cap L = I\cdot L$. Then we have $I = hA_S[X] + I\cdot L$.
  The result then follows from the fact that $h$ is monic and from Nakayama, as in Lam \cite{Lam}:
  the module $M = I/(h)$ is a finitely generated module over $A_S$ and satisfies
  $M\subseteq ML$.
\end{proof}

\begin{corollary}
  We can find comaximal monoids $S_1,\dots,S_l$ such that $I$ is principal and generated by a
  monic polynomial in each $A_{S_j}[X]$.
  In particular, if $A$ is a local ring, we have that $I$ is principal in $A[X]$ and hence $P$
  presents a free module in $A[X]$.
\end{corollary}
