

\newcommand{\inc}{\mathsf{inc}}
\newcommand{\inl}{\mathsf{inl}}
\newcommand{\inr}{\mathsf{inr}}
%\newcommand{\UU}{\mathcal{U}}
\newcommand{\II}{\mathbf{I}}
\newcommand\norm[1]{\left\lVert #1 \right\rVert}

\newcommand{\Gm}{\mathsf{G_m}}
\newcommand{\ext}{\mathsf{ext}}
\newcommand{\patch}{\mathsf{patch}}
\newcommand{\cov}{\mathsf{cov}}
\newcommand{\isSheaf}{\mathsf{isSheaf}}
\newcommand{\Fib}{\mathsf{Fib}}

\newcommand{\BB}{\mathcal{B}}
\newcommand{\CC}{\mathcal{C}}
\newcommand{\UU}{\mathcal{U}}


\subsection{Type theoretic models}

The constructive models of univalence are presheaf models parametrised by an interval object $\II$
(presheaf with two global distinct elements $0$ and $1$ and which is tiny) and a classifier object
$\Phi$ for cofibrations.

 This is over a base category $\BB$.
 
 If we have another category $\CC$, we automatically get a new model of univalent type theory by
 changing $\BB$ to $\BB\times\CC$.

 A particular case is if $\CC$ is the opposite of the category of f.p. $k$-algebras, where $k$ is a
 fixed commutative ring.

 We have the presheaf $R$ defined by $R(J,A) = Hom(k[X],A)$
 where $J$ object of $\BB$ and $A$ object of $\CC$.

  The presheaf $\Gm$ is defined by $\Gm(J,A) = Hom(k[X,1/X],A) = A^{\times}$
  set of invertible elements of $A$.

\subsubsection{$1$-topos model}

We have the presheaf model of type theory over the base category $\CC$.

A context is interpreted as a presheaf over $\CC$. A type over a context $\Gamma$ is interpreted as
a presheaf over the category of elements of $\Gamma$, and an element of this type as a global section
of this presheaf. For any set theoretic universe $\UU$, we have a corresponding presheaf which to
any object $X$ associates the set of $\UU$-small types over $Yo(X)$, and this gives the interpretion
of universes.

\medskip

    In this model we have a presheaf $R(A) = Hom(k[X],A)$ which has a ring structure.

    We have the truth value presheaf $\Omega$ with $\Omega(A)$ is the set of sieves on $A$.
    (There is a predicative version of this object if we are working in a predicative metatheory.)

    We have a dependent type $[p]$ for $p:\Omega$.

    We can consider the family of propositions over $E = R + [0=1]$, with $p_x = \inv(x)\vee\inv(1-x)$
    and $p_z = \perp$ if $z:[0=1]$.

    We can then define the property $\isSheaf$ of being a sheaf for a type $T$ as being the fact that
    the constant maps $T\rightarrow T^{[p_x]}$ are isomorphism for all $x:E$.

    \medskip

    One can check directly that $\Pi_{x:A}B$ is a sheaf if $B$ is a family of sheaves over $A$
    and that $\Sigma_{x:A}B$ is a sheaf if $A$ is a sheaf and $B$ is a family of sheaves.

    \medskip

    Any representable presheaf is a sheaf, and in this new model $R$ is a local ring and we have
    $\neg (0 = 1)$.
    
    \medskip

    However the type of sheaves in given universe $\Sigma_{X:\UU}[\isSheaf(X)]$ is not a sheaf.

    We present another model which both interprets universe and {\em univalence} and
    {\em propositional truncation}.


\subsubsection{Propositional truncation}

    We start by giving a simpler interpretation of propositional truncation. This will simplify
    the proof of the validity of Zariski local choice in the model.

    We work in the presheaf model over a base category $\BB$ which interprets univalent type theory,
    with a presheaf $\Phi$ of cofibrations. The interpretation of the propositional
    truncation $\norm{T}$ {\em don't} require the use of the interval $\II$.

    We recall that in the models, to be contractible can be formulated as having an operation
    $\ext(\psi,v)$ which extends any partial element $v$ of extent $\psi$ to a total element.

    The (new) remark is then that to be a (h)proposition can be formulated as having instead
    an operation 
    $\ext(u,\psi,v)$ which, now {\em given}
    an element $u$, extends any partial element $v$ of extent $\psi$ to a total element.

\medskip    

Propositional truncation is defined as follows. An element of $\norm{T}$ is either of the form
$\inc(a)$ with $a$ in $T$, or of the form $\ext(u,\psi,v)$ where $u$ is in $\norm{T}$ and $\psi$
in $\Phi$ and $v$ a partial element of extent $\psi$.

In this definition, the special constructor $\ext$ is a ``constructor with restrictions'' which
satisfies $\ext(u,\psi,v) = v$ on the extent $\psi$.

\subsubsection{Covering}

We want to force $e_x = \norm{\inv(x)+\inv(1-x)}$ for $x$ in $R$ and $\perp$ if $1=0$.

Note that we have $e_x\rightarrow p_x$, with $p_x$ strict proposition $\inv(x)\vee \inv(1-x)$.
Without choices in the metatheory, we don't have $p_x\rightarrow e_x$.

\begin{lemma}
  The constant map $c:R\rightarrow R^{e_x}$ is an isomorphism and so is $c:R\rightarrow R^{\perp}$ if
  $1 = 0$.
\end{lemma}

\begin{proof}
  It is enough to define a map $\patch:R^{e_x}\rightarrow R$ such that $\patch(c(r)) = r$ since
  $e_x$ is a hproposition.

  If we are at a stage $A$ and $x$ in $A$, and $u:R^{e_x}(A)$ we define $\patch(u)$ as follows.
  Note that $e_x$ becomes inhabited in $A[1/x]$ and $A[1/1-x]$. We get then one element in $A[1/x]$
  and one element in $A[1/1-x]$ using $u$ that are compatible, hence we can patch them together to
  an element in $A$.
\end{proof}

What is going on is that, since $R$ is a strict hset, the canonical map $R^{p_x}\rightarrow R^{e_x}$ is
an isomorphism.

We consider the model which forces all these hpropositions $e_x$ to be contractible
and which forces $\perp$ if $1 = 0$, i.e. we restrict ourseleves to {\em modal types} $T$m the types
$T$ such that $c:T\rightarrow T^{e_x}$ is an {\em equivalence} and $c:T\rightarrow T^{\perp}$ is an equivalence
if $1=0$. (The second condition can be formulated as $(1=0)\rightarrow \isContr(T)$.)

\medskip

We have just seen that the strict hset $R$ is such a modal type.

The same reasoning actually shows that each representable presheaf, in particular $\Gm$, is a modal
(strict) hset.

\medskip

We get a model of type theory with univalence where a type is interpreted as a modal type.
In this model $\perp$ is interpreted as $1=0$. We can check that if $T$ is modal then
$T^{1=0}$ is contractible, since this is equivalent to $(T^{\perp})^{1=0}$.

\medskip

If $P$ is a proposition, then $P$ is modal if, and only if,
we have $P^{e_x}\rightarrow P$ and $1=0\rightarrow P$. (Thus $\perp$ is not modal.)
Since $P$ is a
proposition, $P^{e_x}$ is equivalent to $P^{\inv(x)}\times P^{\inv(1-x)}$.

\medskip

We can use this characterisation of modal proposition to define the interpretation of
$\norm{T}_M(A)$ in this model.

An element in $\norm{T}_M(A)$ is
\begin{enumerate}
\item either $\inc(a)$ with $a$ in $T(A)$
\item or of the form $\ext(u,\psi,v)$ with $u$ in $\norm{T}_M(A)$ and $\psi$ in $\Phi$ and
  $v$ in $\norm{T}_M(A)$ of extent $\psi$
\item or of the form $\cov(x,u_0,u_1)$ with $x$ in $A$ and $u_0$ in $\norm{T}_M(A[1/x])$
  and $u_1$ in $\norm{T}_M(A[1/1-x])$.
\item or of the form $\cov_0$ if $1 = 0$ in $A$  
\end{enumerate}

If $f:A\rightarrow B$ we define the restriction operation inductively as follows.
\begin{enumerate}
\item $\inc(a)|f = \inc(a|f)$
\item $\ext(u,\psi,v)|f = \ext(u|f,\psi,v|f)$
\item $\cov(x,u_0,u_1)|f = \cov(fx,u_0|f_0,u_1|f_1)$ with $x$ in $A$ 
 and $f_0:A[1/x]\rightarrow B[1/fx]$ and $f_1:A[1/1-x]\rightarrow B[1/f(1-x)]$ defined by localisation
\item $\cov_0|f = \cov_0$
\end{enumerate}

If $P$ is a modal proposition and $u:T\rightarrow P$ we can define a map $v:\norm{T}_M\rightarrow P$
such that $v\circ\inc = u$ as a strict equality.

We have $l:\Pi_{x:R}\norm{\inv(x)+\inv(1-x)}_M$ by taking $l(x) = \cov(x,\inc(\inl(1/x)),\inc(\inr(x)))$.

\subsubsection{Zariski local choice}

We prove local choice: if $A$ is a f.p. algebra over $R$ then we have a map
$$
l:(\Pi_{x:Sp(A)}\norm{P})\rightarrow \norm{T(P,A)}
$$
Here $P$ is a dependent type over $Sp(A)$ and $T(P,A)$ is
$$\Sigma_{f_1,\dots,f_n:Cov(A)}\Pi_{D(f_1)}P\times\dots\times\Pi_{D(f_n)}P$$
At a stage $B$ a f.p. algebra over $R$ is given by $B\rightarrow A$ and we have $Yo(B).Sp(A)$ isomorphic
to $Yo(A)$.

For defining the map $l$, we define $l(v)$ by induction on $v$.
The element $v$ is in $(\Pi_{x:Sp(A)}\norm{P})(B)$, which can be seen as
an element of $\norm{P}(A)$. If it is $\inc(u)$ we associate $\inc(1,u)$ with the covering $1$ of $A$.
If it is $\ext(u,\psi,v)$ the image is $\ext(l(u),\psi,l(v))$.
If it is $\cov(x,u_0,u_1)$ we have by induction $l(u_0)$ in $\norm{T(P,A[1/x])}$ and
  $l(u_1)$ in $\norm{T(P,A[1/1-x])}$. We use then 
  $$
\norm{T(P,A[1/x])}\times\norm{T(P,A[1/1-x])}\rightarrow \norm{T(P,A[1/x])\times T(P,A[1/1-x])}
  $$
to get an element in $\norm{T(P,A)}$.

\medskip

The fact that $R$ is local holds like in the $1$-topos case, and similarly for the fact that
$A\rightarrow R^{Sp(A)}$ is an isomorphism for $A$ f.p. over $R$.

\medskip

This model is a simplified version of the sheaf model considered in \cite{CRS21} since we consider only
{\em open} modalities and not the descent data (cobar) modality





\end{document}     
                                                                                  




 
%% The semantics of a type $A:\Type_n$ is given by a pair $C_A,Q_A$ where $C_A(t)$
%% is a set in $U_n$ for $\vdash t:A$ and $Q_A(t_0,\xi_0,t_1,\xi_1)$ is in $U_0$
%% for $\xi_0\in C_A(t_0)$ and $\xi_1\in C_A(t_1)$, and this defines an equivalence
%% relation on $\Sigma (t\in \rightarrowA|) C_A(t)$. We will then have $C_A(\sem{t}{})$ if
%% $\vdash t:A$ and $Q_A(t,\sem{t}{},u,\sem{u}{})$ if $\vdash t=u:A$.
%% Furthermore, we require $C_A(t)\supseteq C_A(t')$ if $t\rightarrow^* t'$
%% and $t = t':A$ and $Q_A(t_0,\xi_0,t_1,\xi_1)$ if $Q_A(t'_0,\xi_0,t'_1,\xi_1)$ and
%% $t_0\rightarrow^* t'_0$ and $t_1\rightarrow^* t'_1$ and $t_0= t'_0:A$
%% and $t_1=t'_1:A$.
