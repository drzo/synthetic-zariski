We only talk about affine schemes of finite type, i.e. schemes of the form $\Spec A$,
where $A$ is a finitely presented algebra.

\begin{definition}%
  A type $X$ is \notion{(qc-)affine},
  if the there is a finitely presented $R$-algebra $A$, such that $X=\Spec A$. 
\end{definition}

\begin{proposition}%
  Let $X$ be a type.
  The type of all finitely presented $R$-algebra $A$, such that $X=\Spec A$, is a proposition.
\end{proposition}

\subsection{Affine-open subtypes}

When we write ``$\Spec A$'' we implicitly assume $A$ is a finitely presented $R$-algebra.

\begin{definition}%
  Let $X=\Spec A$.
  A \notion{(affine) standard open} is the subtype $D(f):X\to\Prop$
  for some $f:\Spec A\to R$ given by $D(f)(x)\colonequiv f(x)\neq 0$.
\end{definition}

\begin{definition}%
  \label{def:affine-open}
  Let $X=\Spec A$.
  A subtype $U:X\to\Prop$ is called \notion{affine-open},
  if one of the following logically equivalent statements holds:
  \begin{enumerate}[(i)]%
  \item $U$ is the union of finitely many affine standard opens.
  \item There are $f_1,\dots,f_n:A$ such that
    \[U(x) \Leftrightarrow \exists_{i} f_i(x)\neq 0 \]
  \end{enumerate}
\end{definition}

We sometimes write $D(f_1, \dots, f_n) \coloneq D(f_1) \cup \dots \cup D(f_n)$
for a finite union of standard opens.
Note that in general, affine-open subtypes do not need to be affine
-- this is why we use the dash ``-''.

We will introduce a more general definition of open subtype in \cref{def:qc-open}
and show in \cref{thm:qc-open-affine-open}, that the two notions agree on affine schemes.

Affine-openness is transitive in the following sense:

\begin{lemma}%
  \label{lem:affine-open-trans}
  Let $X=\Spec A$ and $D(f)\subseteq X$ be a standard open.
  Any affine-open subtype $U$ of $D(f)$ is also affine-open in $X$.
\end{lemma}

\begin{proof}
  It is enough to show the statement for $U=D(g)$, $g:A_f$.
  Then
  \[ g=\frac{h}{f^k}\rlap{.}\]
  Now $D(hf)$ is an affine-open in $X$,
  that coincides with $U$: \\
  Let $x:X$, then $(hf)(x)$ is invertible, if and only if both $h(x)$ and $f(x)$ are invertible.
  The latter means $x:D(f)$, so we can interpret $x$ as a homorphism from $A_f$ to $R$.
  Then $x:D(g)$ means $x(g)$ is invertible, which is equivalent to $x(h)$ being invertible,
  since $x(f)^k$ is invertible anyway.
\end{proof}

\begin{lemma}[using \axiomref{sqc}]%
  \label{lem:standard-open-empty}
  Let $X=\Spec A$ be an affine scheme and $D(f)\subseteq X$ a standard open,
  then $D(f)=\emptyset$, if and only if, $f$ is nilpotent.
\end{lemma}

\begin{proof}
  Since $D(f)=\Spec A_f$, by \cref{Weak-Nullstellensatz}, we know $D(f)=\emptyset$,
  if and only if, $A_f=0$.
  The latter is equivalent to $f$ being nilpotent.
\end{proof}

More generally:

\begin{lemma}[using \axiomref{sqc}]%
  Let $A$ be a finitely presented $R$-algebra
  and let $f, g_1, \dots, g_n \in A$.
  Then we have $D(f) \subseteq D(g_1, \dots, g_n)$
  as subsets of $\Spec A$
  if and only if $f \in \sqrt{(g_1, \dots, g_n)}$.
\end{lemma}

\begin{proof}
  Since $D(g_1, \dots, g_n) = \{\, x \in \Spec A \mid x \notin V(g_1, \dots, g_n) \,\}$,
  the inclusion $D(f) \subseteq D(g_1, \dots, g_n)$
  can also be written as
  $D(f) \cap V(g_1, \dots, g_n) = \varnothing$, that is,
  $\Spec((A/(g_1, \dots, g_n))[f^{-1}]) = \varnothing$.
  By (\axiomref{sqc})
  this means that the finitely presented $R$-algebra $(A/(g_1, \dots, g_n))[f^{-1}]$
  is zero.
  And this is the case if and only if $f$ is nilpotent in $A/(g_1, \dots, g_n)$,
  that is, if $f \in \sqrt{(g_1, \dots, g_n)}$, as stated.
\end{proof}

\subsection{Fiber products}

\begin{lemma}[using \axiomref{sqc}]%
  \label{lem:affine-fiber-product}
  Let $X=\Spec A,Y=\Spec B$ and $Z=\Spec C$ be affine schemes
  with maps $f:X\to Z$, $g:Y\to Z$.
  Then the pullback of this diagram is an affine scheme given by $\Spec (A\otimes_C B)$.
\end{lemma}

\begin{proof}
  The maps $f:X\to Z$, $g:Y\to Z$ are induced by $R$-algebra homomorphisms $f^*:A\to R$ and $g^*:B\to R$.
  Let
  \[ (h,k,p) : \Spec A \times_{\Spec C} \Spec B \]
  with $p:h\circ f^*=k\circ g^* $.
  This defines a $R$-cocone on the diagram
  \[
    \begin{tikzcd}
      A & C\ar[r,"g^*"]\ar[l,"f^*",swap] & B
    \end{tikzcd}
  \]
  Since $A\otimes_C B$ is a pushout in $R$-algebras,
  there is a unique $R$-algebra homomorphism $A\otimes_C B \to R$ corresponding to $(h,k,p)$.
\end{proof}

\subsection{Boundedness of functions to $\N$}

\begin{theorem}[using (\axiomref{loc}), (\axiomref{sqc})]%
  \label{thm:boundedness}
  Let $A$ be a finitely presented $R$-algebra.
  Then every function $f : \Spec A \to \N$ is bounded:
  \[ \Pi_{f : \Spec A \to \N} \propTrunc{\Sigma_{n : \N} \Pi_{x : \Spec A} f(x) \le n}
     \rlap{.} \]
\end{theorem}

\begin{proof}
  Let $f : \Spec A \to \N$ be given.
  We compose this function with the embedding
  \[ \begin{tikzcd}[row sep=0mm]
    \N \ar[r, "\iota"] & R[X] \ar[r, phantom, "{=}"] & (\bA^1 \to R) \\
    n \ar[r, mapsto] & X^n
  \end{tikzcd} \]
  (it is an embedding since $1 \neq 0 \in R$ by (\axiomref{loc}))
  to obtain $\widetilde{f} : \Spec A \to (\bA^1 \to R)$
  and its transpose $g : \Spec A \times \bA^1 \to R$.
  Since $\Spec A \times \bA^1 = \Spec (A \otimes R[X]) = \Spec A[X]$
  (see~\ref{MISSING}),
  we can regard $g$ as an element of $A[X]$.
  For $x \in \Spec A$,
  the polynomial $\iota(f(x)) \in R[X]$ is then obtained from the polynomial~$g$
  by applying the $R$-algebra homomorphism $x : A \to R$ to all coefficients.
  This makes it clear that
  we have a common bound on the degrees of the polynomials $\iota(f(x))$,
  in other words,
  the function $f$ is bounded.
\end{proof}
