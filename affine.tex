We only talk about affine schemes of finite type, i.e. schemes of the form $\Spec A$,
where $A$ is a finitely presented algebra.

\begin{definition}%
  A type $X$ is \notion{(qc-)affine},
  if the there is a finitely presented $R$-algebra $A$, such that $X=\Spec A$. 
\end{definition}

\begin{proposition}%
  Let $X$ be a type.
  The type of all finitely presented $R$-algebra $A$, such that $X=\Spec A$, is a proposition.
\end{proposition}

\subsection{Affine-open subtypes}

When we write ``$\Spec A$'' we implicitly assume $A$ is a finitely presented $R$-algebra.

\begin{definition}%
  Let $X=\Spec A$.
  A \notion{(affine) standard open} is the subtype $D(f):X\to\Prop$
  for some $f:\Spec A\to R$ given by $D(f)(x)\colonequiv f(x)\neq 0$.
\end{definition}

\begin{definition}%
  \label{def:affine-open}
  Let $X=\Spec A$.
  A subtype $U:X\to\Prop$ is called \notion{affine-open},
  if one of the following logically equivalent statements holds:
  \begin{enumerate}[(i)]%
  \item $U$ is the intersection of finitely many affine standard opens.
  \item There are $f_1,\dots,f_n:A$ such that
    \[U(x) \Leftrightarrow \exists_{i}f_i\neq 0 \]
  \end{enumerate}
\end{definition}

Note that in general, affine-open subtypes do not need to be affine
-- this is why we use the dash ``-''.

We will introduce a more general definition of open subtype in \cref{def:qc-open}
and show in \cref{thm:qc-open-affine-open}, that the two notions agree on affine schemes.

Affine-openness is transitive in the following sense:

\begin{lemma}%
  \label{lem:affine-open-trans}
  Let $X=\Spec A$ and $D(f)\subseteq X$ be a standard open.
  Any affine-open subtype $U$ of $D(f)$ is also affine-open in $X$.
\end{lemma}

\begin{proof}
  It is enough to show the statement for $U=D(g)$, $g:A_f$.
  Then
  \[ g=\frac{h}{f^k}\rlap{.}\]
  Now $D(hf)$ is an affine-open in $X$,
  that coincides with $U$: \\
  Let $x:X$, then $(hf)(x)$ is invertible, if and only if both $h(x)$ and $f(x)$ are invertible.
  The latter means $x:D(f)$, so we can interpret $x$ as a homorphism from $A_f$ to $R$.
  Then $x:D(g)$ means $x(g)$ is invertible, which is equivalent to $x(h)$ being invertible,
  since $x(f)^k$ is invertible anyway.
\end{proof}

\subsection{Fiber products}

\begin{lemma}[(\axiomref{sqc})]%
  \label{lem:affine-fiber-product}
  Let $X=\Spec A,Y=\Spec B$ and $Z=\Spec C$ be affine schemes
  with maps $f:X\to Z$, $g:Y\to Z$.
  Then the pullback of this diagram is an affine scheme given by $\Spec (A\otimes_C B)$.
\end{lemma}

\begin{proof}
  The maps $f:X\to Z$, $g:Y\to Z$ are induced by $R$-algebra homomorphisms $f^*:A\to R$ and $g^*:B\to R$.
  Let
  \[ (h,k,p) : \Spec A \times_{\Spec C} \Spec B \]
  with $p:h\circ f^*=k\circ g^* $.
  This defines a $R$-cocone on the diagram
  \[
    \begin{tikzcd}
      A & C\ar[r,"g^*"]\ar[l,"f^*",swap] & B
    \end{tikzcd}
  \]
  Since $A\otimes_C B$ is a pushout in $R$-algebras,
  there is a unique $R$-algebra homomorphism $A\otimes_C B \to R$ corresponding to $(h,k,p)$.
\end{proof}


\subsection{Equality types}

\begin{lemma}%
  Let $X$ be an affine scheme and $x,y:X$,
  then $x=_Xy$ is an affine scheme.
\end{lemma}

\begin{proof}
  Any affine scheme is merely embedded into $\A^n$ for some $n:\N$.
  The proposition $x=y$ for elements $x,y:\A^n$ is equivalent to $x-y=0$,
  which is equivalent to all entries of this vector being zero.
\end{proof}
